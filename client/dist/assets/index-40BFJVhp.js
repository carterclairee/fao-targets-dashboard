import{j as e,r as x,a as S}from"./react-Bswn7Xpn.js";import{c as A}from"./react-dom-Jf2g30Uk.js";import{L as B,B as O}from"./react-router-dom-CTr2x-5s.js";import{a as R,d as E,e as D,f as N}from"./react-router-C45aSSP9.js";import{a as I}from"./axios-DW_MHI2K.js";import{P as k}from"./react-plotly.js-B7WhicGm.js";import{u as L,f as C,g as P}from"./@tanstack-6apjpwpR.js";import"./plotly.js-basic-dist-hD-yW4Zm.js";import"./scheduler-DYLXRpC5.js";import"./@remix-run-CSkcHbWt.js";import"./prop-types-BKNjMPK8.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const G="/assets/EuFMD_2023_white_xl-DJ9puaey.png",U=()=>e.jsx("nav",{className:"w-full bg-gradient-to-t from-darkTeal to-darkGreen h-16 flex items-center",children:e.jsx("div",{className:"ml-4",children:e.jsx(B,{to:"/",children:e.jsx("img",{src:G,alt:"FAO Logo",className:"max-h-28 w-auto"})})})}),w=({infoText:t})=>{const[r,a]=x.useState(!1),n=()=>{a(!0)},o=()=>{a(!1)};return e.jsxs("div",{className:"relative inline-block overflow-visible",children:[e.jsx("button",{onMouseEnter:n,onMouseLeave:o,className:"info-button w-4 h-4 bg-gray-1 rounded-full text-white italic border border-white flex items-center justify-center",style:{fontSize:"10px"},children:"i"}),r&&e.jsx("div",{className:"absolute left-0 mt-1 w-48 p-1 bg-white border rounded shadow-lg text-xs",style:{zIndex:1},children:t})]})},K="/assets/EN-Funded%20by%20the%20EU-WHITE-ChYk5Q9d.png",$=()=>e.jsx("footer",{className:"w-full bg-gradient-to-t from-darkTeal to-darkGreen flex items-center py-6 mt-6",children:e.jsxs("div",{className:"ml-11",children:[e.jsx("img",{className:"max-w-52 h-auto mb-4",src:K,alt:"funded by EU"}),e.jsx("p",{className:"text-white text-sm/4",children:"European Commission for the Control of Foot-and-Mouth Disease"}),e.jsx("a",{href:"https://www.fao.org/eufmd/en/",className:"text-white text-sm/4",children:"fao.org/eufmd/"}),e.jsx("p",{className:"text-white text-xs mt-4",children:"Â© 2025 | EuFMD"})]})}),_=window.location.hostname==="localhost"?"http://localhost:5000":"https://eufmd-targets.onrender.com/",H=()=>{var s,l,u;const[t,r]=x.useState([]),a=R();x.useEffect(()=>{n()},[]);const n=async()=>{try{const i=(await(await fetch(`${_}/api/targets/`,{method:"GET",headers:{"Content-Type":"application/json"}})).json()).map(p=>({id:p.focus_objective_id,name:p.focus_objective_name}));let f=[],j=[];for(const p of i)if(j.includes(p.id)||(j.push(p.id),f.push(p)),f.length===3)break;r(f)}catch(d){console.log("Error fetching focus objectives: ",d)}},o=d=>a(`/focus-objective/${d}`);return e.jsxs("div",{children:[e.jsx("h1",{className:"page-heading",children:"EuFMD Milestones"}),e.jsxs("div",{className:"relative h-screen mx-auto",children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"container relative min-w-[600px] max-w-[600px] h-[600px] rounded-full bg-white overflow-hidden flex items-center justify-center border-2 border-white",children:t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"polypieceInner absolute w-full h-full bg-darkGreen hover:bg-greyGreen",style:{clipPath:"polygon(50.3% 50%, 100% 1%, 100% 240%)",transform:"rotate(194deg)"},onClick:()=>o(t[0].id)}),e.jsx("div",{className:"polypieceInner absolute w-full h-full bg-lighterTeal hover:bg-greyGreen",style:{clipPath:"polygon(50.3% 50%, 100% 1%, 100% 240%)",transform:"rotate(314deg)"},onClick:()=>o(t[1].id)}),e.jsx("div",{className:"polypieceInner absolute w-full h-full bg-darkTeal hover:bg-greyGreen",style:{clipPath:"polygon(50.3% 50%, 100% 1%, 100% 240%)",transform:"rotate(74deg)"},onClick:()=>o(t[2].id)})]})})}),e.jsxs("svg",{className:"absolute inset-0 w-full h-full pointer-events-none",viewBox:"0 0 700 700",preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("text",{x:"30%",y:"38%",dominantBaseline:"middle",textAnchor:"middle",className:"circle-text",children:"Protection of Livestock"}),e.jsx("text",{x:"70%",y:"38%",dominantBaseline:"middle",textAnchor:"middle",className:"circle-text",children:"Respond to Crises"}),e.jsx("text",{x:"50%",y:"73%",dominantBaseline:"middle",textAnchor:"middle",className:"circle-text",children:"Control of Diseases"})]}),t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-[40%] left-[40%]",children:e.jsx(w,{infoText:((s=t[0])==null?void 0:s.name)||""})}),e.jsx("div",{className:"absolute top-[40%] left-[60%]",children:e.jsx(w,{infoText:((l=t[1])==null?void 0:l.name)||""})}),e.jsx("div",{className:"absolute top-[75%] left-[50%]",children:e.jsx(w,{infoText:((u=t[2])==null?void 0:u.name)||""})})]})]}),e.jsx($,{})]})},z=()=>e.jsx("div",{children:e.jsx("div",{className:"container mx-auto mt-8",children:e.jsx("h1",{className:"text-3xl font-bold underline",children:"PAGE NOT FOUND!"})})}),V=t=>t.reduce((r,a)=>{const n=r.find(o=>o.key_area_id===a.key_area_id);return n?n.items.push(a):r.push({key_area_id:a.key_area_id,items:[a]}),r},[]),T=t=>{const r=t.indexOf("["),a=t.indexOf("]"),n=t.slice(r+1,a).toUpperCase().trim(),o=t.slice(a+1).trim();let s="";switch(n){case"RISK MONITORING":s="Risk Monitoring";break;case"RISK MITIGATION":s="Risk Mitigation";break;case"CAPACITY DEVELOPMENT":s="Capacity Development";break;case"TOOLS AND RESOURCES":s="Tools and Resources";break;case"GLOBAL FMD CONTROL":s="Global FMD Control";break;case"FAST CONTROL":s="FAST Control";break;case"VACCINE SECURITY":s="Vaccine Security";break;default:s="Unknown Key Area"}return[s,o]},g=t=>t.filter(a=>a.result_to_date>=a.program_target).length,Y=t=>t.filter(r=>r.result_to_date>0&&r.result_to_date<r.program_target).length,q=t=>t.filter(r=>r.result_to_date===0||r.result_to_date===null).length,J=(t,r)=>t>=r?"Met":t>0?"In progress":"Not started",Q=t=>{const r=g(t),a=t.length,n=a-r;return{metCount:r,notMetCount:n,total:a}},W=({data:t})=>{const{metCount:r,notMetCount:a,total:n}=Q(t);return e.jsx(k,{data:[{type:"pie",labels:["Met Targets","Unmet Targets"],values:[r,a],hole:.7,textinfo:"none",marker:{colors:["#048B5D","#9ea6a1B3"]}}],layout:{width:200,height:200,title:"",showlegend:!1,annotations:[{x:.5,y:.5,xref:"paper",yref:"paper",text:`${r} of ${n}<br>targets met`,showarrow:!1,font:{size:18,color:"#000000",family:"Helvetica, Arial, sans-serif"}}],margin:{t:0,b:0,l:0,r:0}},config:{responsive:!0,displayModeBar:!1}})},X=t=>{const r=t.filter(s=>s.target_timeframe==="Short-term goal"),a=t.filter(s=>s.target_timeframe==="Mid-term goal"),n=t.filter(s=>s.target_timeframe==="Long-term goal");return{shortTermMet:g(r),midTermMet:g(a),longtermMet:g(n),shortTermUnmet:r.length-g(r),midTermUnmet:a.length-g(a),longTermUnmet:n.length-g(n)}},Z=({data:t})=>{const{shortTermMet:r,midTermMet:a,longtermMet:n,shortTermUnmet:o,midTermUnmet:s,longTermUnmet:l}=X(t);return e.jsx(k,{data:[{type:"bar",x:[r,a,n],y:["Short-term","Mid-term","Long-term"],orientation:"h",name:"Met Goals",marker:{color:"#048B5D"}},{type:"bar",x:[o,s,l],y:["Short-term","Mid-term","Long-term"],name:"Unmet Goals",orientation:"h",marker:{color:"#9ea6a1B3"}}],layout:{width:300,height:200,title:{text:"Targets Met by Timeframe",font:{size:18,color:"black",family:"Helvetica, Arial, sans-serif"}},barmode:"stack",showlegend:!1,xaxis:{title:{text:"Number of targets met",font:{family:"Helvetica, Arial, sans-serif",color:"black"}},dtick:1,tickfont:{size:8}},yaxis:{tickfont:{color:"black",family:"Helvetica, Arial, sans-serif"}},margin:{t:40,b:40,l:75,r:15}},config:{responsive:!0,displayModeBar:!1}})},ee=()=>{const[t,r]=x.useState(""),[a,n]=x.useState([]),{focusObjectiveId:o}=E(),s=Number(o),l=R();x.useEffect(()=>{y(s),s&&u(s)},[s]);const u=async i=>{try{const f=await I.get(`${_}/api/targets/focus_objective/${i}`),j=V(f.data);n(j)}catch(f){console.error("Error fetching data: ",f)}},d=(i,f)=>l(`/focus-objective/${i}/key-area/${f}`),y=i=>{r(i===1?"Protection of Livestock":i===2?"Respond to Crises":i===3?"Control of Diseases":"")};return e.jsxs("div",{children:[e.jsxs("h1",{className:"page-heading",children:[t," Key Areas"]}),a.length>0&&e.jsx("div",{className:"container mx-auto w-full mt-7",children:e.jsx("div",{className:"flex flex-wrap justify-center gap-7",children:a.map(i=>e.jsxs("div",{className:"bg-white shadow-md rounded-md p-4 border border-gray-200 w-80 cursor-pointer overflow-hidden transform transition-transform duration-300 hover:shadow-lg hover:scale-105",onClick:()=>d(s,i.key_area_id),children:[e.jsx("h2",{className:"font-bold text-xl text-center",children:T(i.items[0].key_area_name)[0]}),e.jsx("div",{className:"flex justify-center items-center w-full mt-7",children:e.jsx(W,{data:i.items})}),e.jsx("div",{className:"flex justify-center items-center w-full mt-7",children:e.jsx(Z,{data:i.items})})]},i.key_area_id))})})]})},v=({label:t,value:r,color:a})=>e.jsx("div",{className:"bg-white shadow-md rounded-md p-4 border border-gray-200 w-48",children:e.jsxs("div",{className:"grid grid-cols-[0.4fr_1fr]  gap-1 items-center",children:[e.jsx("p",{className:`font-bold text-3xl ${a} text-center`,children:r}),e.jsx("p",{className:"text-left",children:t})]})}),te=({result_to_date:t,program_target:r})=>{const a=Math.max(r-t,0);let n="#9ea6a1B3";return t>=r?n="#048B5D":t>0&&(n="#28949C"),e.jsx(k,{data:[{type:"bar",orientation:"h",x:[t],y:[""],name:"Current",marker:{color:n}},{type:"bar",orientation:"h",x:[a],y:[""],name:"Remaining",marker:{color:"#9ea6a1B3"}}],layout:{barmode:"stack",height:20,width:175,margin:{l:5,r:0,t:10,b:0},showlegend:!1,xaxis:{visible:!1},yaxis:{visible:!1}},config:{displayModeBar:!1}})},se=({data:t})=>{const r=x.useMemo(()=>[{accessorKey:"expected_result",header:"Expected Result"},{accessorKey:"indicator",header:"Indicator"},{accessorKey:"target_description",header:"Target description"},{accessorKey:"progress",header:"Progress",cell:({row:s})=>{const l=s.original.result_to_date??0,u=s.original.program_target??0;return e.jsxs("div",{children:[e.jsx(te,{result_to_date:l,program_target:u}),e.jsxs("p",{className:"text-center text-sm mb-1",children:[l," of ",u]})]})}}],[]);let a={};t.forEach(s=>{a[s.expected_result]?a[s.expected_result]+=1:a[s.expected_result]=1});let n=new Set;const o=L({data:t,columns:r,getCoreRowModel:P()});return e.jsxs("table",{children:[e.jsx("thead",{className:"whitespace-nowrap",children:o.getHeaderGroups().map(s=>e.jsx("tr",{className:"border-b-4 border-lighterTeal",children:s.headers.map(l=>e.jsx("th",{className:"p-3 text-left text-lg font-bold",children:C(l.column.columnDef.header,l.getContext())},l.id))},s.id))}),e.jsx("tbody",{children:o.getRowModel().rows.map(s=>{const l=s.original.expected_result,u=!n.has(l);return u&&n.add(l),e.jsxs("tr",{className:"border-b border-lighterTeal",children:[u&&e.jsx("td",{rowSpan:a[l],className:"p-3",children:s.original.expected_result}),s.getVisibleCells().map(d=>d.column.id==="expected_result"?null:e.jsx("td",{className:"p-3",children:C(d.column.columnDef.cell,d.getContext())},d.id))]},s.id)})})]})},M=({categories:t,selectedCategories:r,filter:a,handleFilterChange:n})=>e.jsx("div",{className:"flex flex-col gap-2 px-3 mb-4",children:t.map(o=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",value:o,checked:r.includes(o),onChange:()=>n(a,o),className:"w-4 h-4 accent-greyGreen"}),o]},o))}),re=()=>{const[t,r]=x.useState([]),[a,n]=x.useState([]),[o,s]=x.useState([]),{focusObjectiveId:l,keyAreaId:u}=E(),d=Number(l),y=Number(u),i=async(m,c)=>{try{const h=await I.get(`${_}/api/targets/focus_objective/${m}/key_area/${c}`);r(h.data)}catch(h){console.error("Error fetching data: ",h)}};x.useEffect(()=>{i(d,y)},[]);const f=(m,c)=>{console.log("handleFilterChange called with:"),console.log("filterType:",m),console.log("value:",c),m==="timeframe"?n(h=>h.includes(c)?h.filter(b=>b!==c):[...h,c]):m==="status"&&s(h=>h.includes(c)?h.filter(b=>b!==c):[...h,c])},j=a.length||o.length?t.filter(m=>{const c=J(m.result_to_date,m.program_target),h=a.length?a.includes(m.target_timeframe):!0,b=o.length?o.includes(c):!0;return h&&b}):t,p=["Short-term goal","Mid-term goal","Long-term goal"],F=["Met","In progress","Not started"];return e.jsx("div",{children:t.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"page-heading",children:[T(t[0].key_area_name)[0]," Targets"]}),e.jsx("h2",{className:"text-center",children:T(t[0].key_area_name)[1]}),e.jsx("div",{className:"container mx-auto w-full mt-7",children:e.jsxs("div",{className:"flex flex-wrap justify-center gap-8",children:[e.jsx(v,{label:"targets total",color:"text-black",value:t.length}),e.jsx(v,{label:g(t)===1?"target met":"targets met",color:"text-darkGreen",value:g(t)}),e.jsx(v,{label:"in progress",color:"text-brightBlue",value:Y(t)}),e.jsx(v,{label:"not started",color:"text-darkRed",value:q(t)})]})}),e.jsxs("div",{className:"mt-9 grid grid-cols-[1fr_5fr] gap-4",children:[e.jsxs("div",{className:"mx-auto w-full bg-white shadow-md rounded-md px-7 py-5 border border-gray-200",children:[e.jsx("h2",{className:"font-bold text-2xl text-darkTeal px-3",children:"Filters"}),e.jsxs("div",{children:[e.jsx("h3",{className:"p-3 text-left text-lg font-bold",children:"Status"}),e.jsx(M,{categories:F,selectedCategories:o,filter:"status",handleFilterChange:(m,c)=>f(m,c)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"p-3 text-left text-lg font-bold",children:"Goal Length"}),e.jsx(M,{categories:p,selectedCategories:a,filter:"timeframe",handleFilterChange:(m,c)=>f(m,c)})]})]}),e.jsxs("div",{className:"mx-auto w-full bg-white shadow-md rounded-md pl-7 pr-10 pt-5 pb-10 border border-gray-200",children:[e.jsx("h2",{className:"font-bold text-2xl text-darkTeal px-3",children:"Targets"}),e.jsx(se,{data:j})]})]})]})})},ae=()=>e.jsx("div",{className:"min-h-screen bg-greyGreen bg-opacity-10",children:e.jsxs(O,{children:[e.jsx(U,{}),e.jsxs(D,{children:[e.jsx(N,{path:"/",element:e.jsx(H,{})}),e.jsx(N,{path:"/focus-objective/:focusObjectiveId",element:e.jsx(ee,{})}),e.jsx(N,{path:"/focus-objective/:focusObjectiveId/key-area/:keyAreaId",element:e.jsx(re,{})}),e.jsx(N,{path:"*",element:e.jsx(z,{})})]})]})}),oe=A.createRoot(document.getElementById("root"));oe.render(e.jsx(S.StrictMode,{children:e.jsx(ae,{})}));
